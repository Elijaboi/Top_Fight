<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="./style.css">
        <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
    </head>
    <body>
        <script>
            var config = {
                type: Phaser.AUTO,
                width: 800,
                height: 600,
                physics: {
                    default: 'arcade',
                    arcade: {
                        gravity: { z: 200 }
                    }
                },
                scene: {
                    preload: preload,
                    create: create,
                    update: update
                }
            };
        
            var game = new Phaser.Game(config);

            //initialise global variables
            var player;
            var obstacles;
            var cursors;
            
            var yLimit;
            var xLimit;
        
            function preload ()
            {
                this.load.image('sky', 'assets/octagon.jpg');
                this.load.image('circle', 'assets/circle.png');
                this.load.image('grey_tile', 'assets/grey_tile.png');   
            }
        
            function create ()
            {
                let background = this.add.image(0, 0, 'sky');
                item1 = this.add.image(380, 320, 'grey_tile');
                item2 = this.add.image(310, 320, 'grey_tile');
                item3 = this.add.image(450, 320, 'grey_tile');
                item4 = this.add.image(380, 250, 'grey_tile');
                item5 = this.add.image(310, 250, 'grey_tile');
                item6 = this.add.image(450, 250, 'grey_tile');
                item8 = this.add.image(380, 390, 'grey_tile');
                item9 = this.add.image(310, 390, 'grey_tile');
                item10 = this.add.image(450, 390, 'grey_tile');
                background.x = background.displayWidth / 2;
                background.y = background.displayHeight/1.5;
                xLimit = background.displayWidth; //the player cannot go beyond these x and
                yLimit = background.displayHeight;
                //var particles = this.add.particles('circle');
                player = this.physics.add.sprite(380, 320, 'circle'); //create the player sprite
                player.setScale(0.4);
               // var emitter = particles.createEmitter({
                  //  speed: 100,
                  //  scale: { start: 1, end: 0 },
                   // blendMode: 'ADD'
               // });    
               item1.setInteractive().on('pointerover', function() {item1.setTint(0x39FF14)});
               item1.setInteractive().on('pointerout', function() {item1.setTint()});
               cursors = this.input.keyboard.createCursorKeys();   
               this.input.keyboard.on('keydown-A', function (event) {

                player.angle += 1;

}); 
            }

            function update ()
            {console.log(Phaser.Math.Distance.Chebyshev(player.x,player.y,item1.x,item1.y));
                if (cursors.left.isDown && player.x >= 0) {
                    player.body.x -= 10;
                    // player.setVelocityX(-200); //go left
  }
  else if (cursors.right.isDown && player.x <= xLimit) {
    player.body.x += 10; 
    // player.setVelocityX(200); //go right
  }
  else {
      player.setVelocityX(0); //don't move left or right
            }
            if (cursors.up.isDown && player.y >= 0) {
    player.body.y -= 10;; //move up
}
else if (cursors.down.isDown && player.y <= yLimit) {
    player.body.y += 10;
    //player.angle += 1;; //move down
}
else if 
 (Phaser.Input.Keyboard.JustDown('keydown-A') && player.y <= yLimit) {
    //player.body.y += 10;
    player.angle += 1; //move down
}
else {
    player.setVelocityY(0); //don't move up or down
}
//if (Math.hypot(player.x, player.y) < 100)
if(Phaser.Math.Distance.Chebyshev(player.x,player.y,item1.x,item1.y)<100)
{item1.setTint(0x39FF14);}
else {
    item1.setTint();
}


        }
            </script>
    </body>
</html>